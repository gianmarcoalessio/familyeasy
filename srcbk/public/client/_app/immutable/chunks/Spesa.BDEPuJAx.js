import{s as Ne,l as ye,e as h,t as fe,a as z,c as _,b as U,d as de,g as R,f as C,m as X,o as m,i as te,h as o,r as pe,p as W,j as be,q as Ee,u as Oe,v as Ve,w as He,x as Ae,n as je,y as Pe}from"./scheduler.335M-m3f.js";import{S as Qe,i as Ye,b as we,c as se,a as oe,m as re,t as ie,d as ue,e as ce}from"./index.K2G5X1vL.js";import{e as De}from"./each.6w4Ej4nR.js";import{I as Se}from"./Input.BkZDYS4g.js";import{C as $e,S as Ge}from"./Search.234XupZN.js";import{u as Xe,e as xe}from"./servizi.Tbb05M6l.js";function Ie(e,a,t){const r=e.slice();return r[19]=a[t],r[20]=a,r[21]=t,r}function ze(e){let a,t="Modificare i campi per la spesa selezionata";return{c(){a=h("div"),a.textContent=t},l(r){a=_(r,"DIV",{"data-svelte-h":!0}),X(a)!=="svelte-1bnwxsv"&&(a.textContent=t)},m(r,f){te(r,a,f)},d(r){r&&C(a)}}}function Re(e){let a,t="x",r,f;function d(){return e[16](e[21])}return{c(){a=h("button"),a.textContent=t,this.h()},l(b){a=_(b,"BUTTON",{class:!0,"data-svelte-h":!0}),X(a)!=="svelte-s6j59f"&&(a.textContent=t),this.h()},h(){m(a,"class","btn btn-third")},m(b,v){te(b,a,v),r||(f=W(a,"click",d),r=!0)},p(b,v){e=b},d(b){b&&C(a),r=!1,f()}}}function Me(e){let a,t,r,f=e[19].user.username+"",d,b,v,u,s,k,D,B,y,p,A,L,q,N,H;function V(){e[15].call(u,e[20],e[21])}let g=e[21]>0&&!e[2]&&Re(e);return{c(){a=h("tr"),t=h("td"),r=fe("@"),d=fe(f),b=z(),v=h("td"),u=h("input"),B=z(),y=h("td"),p=h("input"),L=z(),q=h("td"),g&&g.c(),this.h()},l(n){a=_(n,"TR",{});var i=U(a);t=_(i,"TD",{class:!0});var T=U(t);r=de(T,"@"),d=de(T,f),T.forEach(C),b=R(i),v=_(i,"TD",{});var O=U(v);u=_(O,"INPUT",{type:!0,class:!0,placeholder:!0}),O.forEach(C),B=R(i),y=_(i,"TD",{class:!0});var Z=U(y);p=_(Z,"INPUT",{type:!0,class:!0}),Z.forEach(C),L=R(i),q=_(i,"TD",{});var x=U(q);g&&g.l(x),x.forEach(C),i.forEach(C),this.h()},h(){m(t,"class","w-20"),m(u,"type","number"),m(u,"class",s="w-40 text-lg p-2 text-center rounded-lg "+(e[19].rimborso?"text-success":"text-error")),m(u,"placeholder",k=he(e[19].cost)),u.disabled=D=e[21]==0&&e[3].name==="Rimborso",m(p,"type","checkbox"),p.disabled=!0,m(p,"class","toggle"),p.checked=A=e[19].rimborso,m(y,"class","w-16")},m(n,i){te(n,a,i),o(a,t),o(t,r),o(t,d),o(a,b),o(a,v),o(v,u),pe(u,e[19].cost),o(a,B),o(a,y),o(y,p),o(a,L),o(a,q),g&&g.m(q,null),N||(H=W(u,"input",V),N=!0)},p(n,i){e=n,i&1&&f!==(f=e[19].user.username+"")&&be(d,f),i&1&&s!==(s="w-40 text-lg p-2 text-center rounded-lg "+(e[19].rimborso?"text-success":"text-error"))&&m(u,"class",s),i&1&&k!==(k=he(e[19].cost))&&m(u,"placeholder",k),i&8&&D!==(D=e[21]==0&&e[3].name==="Rimborso")&&(u.disabled=D),i&1&&Ae(u.value)!==e[19].cost&&pe(u,e[19].cost),i&1&&A!==(A=e[19].rimborso)&&(p.checked=A),e[21]>0&&!e[2]?g?g.p(e,i):(g=Re(e),g.c(),g.m(q,null)):g&&(g.d(1),g=null)},d(n){n&&C(a),g&&g.d(),N=!1,H()}}}function Ue(e){let a,t,r="Elimina",f,d,b="Modifica",v,u;return{c(){a=h("div"),t=h("button"),t.textContent=r,f=z(),d=h("button"),d.textContent=b,this.h()},l(s){a=_(s,"DIV",{class:!0});var k=U(a);t=_(k,"BUTTON",{class:!0,"data-svelte-h":!0}),X(t)!=="svelte-1xzvrry"&&(t.textContent=r),f=R(k),d=_(k,"BUTTON",{class:!0,"data-svelte-h":!0}),X(d)!=="svelte-qdnvb2"&&(d.textContent=b),k.forEach(C),this.h()},h(){m(t,"class","btn btn-error"),m(d,"class","btn btn-success flex-1"),m(a,"class","flex flex-row space-x-2 mt-4")},m(s,k){te(s,a,k),o(a,t),o(a,f),o(a,d),v||(u=[W(t,"click",e[9]),W(d,"click",e[8])],v=!0)},p:je,d(s){s&&C(a),v=!1,Ve(u)}}}function Fe(e){let a,t,r,f=e[2]?"Visualizza":"Modifica",d,b,v=e[4]?"Rimborso":"Spesa",u,s,k,D,B,y,p,A,L,q,N,H,V,g,n,i,T,O,Z="<tr><th>Username</th> <th>Quota</th> <th>Spesa/Rimborso</th> <th></th></tr>",x,Y,ae,F,ve="",_e,le,J,j,Te="Close",ne,P,me,Ce,M=!e[2]&&ze();function Be(l){e[12](l)}let ke={};e[0].category!==void 0&&(ke.categoria=e[0].category),p=new $e({props:ke}),ye.push(()=>we(p,"categoria",Be)),p.$on("change",e[13]);function Le(l){e[14](l)}let qe={type:"date"};e[0].date!==void 0&&(qe.value=e[0].date),q=new Se({props:qe}),ye.push(()=>we(q,"value",Le)),V=new Ge({props:{topleftlabel:e[4]?"Aggiungere gli utenti da rimborsare":"Cerca un utente a cui associare una quota"}}),V.$on("add",e[7]),n=new Se({props:{topleftlabel:"Totale spesa (somma delle quote)",disabled:!0,value:he(e[5])}});let K=De(e[0].quote),E=[];for(let l=0;l<K.length;l+=1)E[l]=Me(Ie(e,K,l));let S=!e[2]&&Ue(e);return{c(){a=h("dialog"),t=h("div"),r=h("div"),d=fe(f),b=z(),u=fe(v),s=z(),M&&M.c(),k=z(),D=h("textarea"),B=z(),y=h("div"),se(p.$$.fragment),L=z(),se(q.$$.fragment),H=z(),se(V.$$.fragment),g=z(),se(n.$$.fragment),i=z(),T=h("table"),O=h("thead"),O.innerHTML=Z,x=z(),Y=h("tbody");for(let l=0;l<E.length;l+=1)E[l].c();ae=z(),F=h("tbody"),F.innerHTML=ve,_e=z(),S&&S.c(),le=z(),J=h("div"),j=h("button"),j.textContent=Te,this.h()},l(l){a=_(l,"DIALOG",{class:!0});var w=U(a);t=_(w,"DIV",{class:!0});var c=U(t);r=_(c,"DIV",{class:!0});var $=U(r);d=de($,f),b=R($),u=de($,v),$.forEach(C),s=R(c),M&&M.l(c),k=R(c),D=_(c,"TEXTAREA",{class:!0,placeholder:!0}),U(D).forEach(C),B=R(c),y=_(c,"DIV",{class:!0});var G=U(y);oe(p.$$.fragment,G),L=R(G),oe(q.$$.fragment,G),G.forEach(C),H=R(c),oe(V.$$.fragment,c),g=R(c),oe(n.$$.fragment,c),i=R(c),T=_(c,"TABLE",{class:!0});var Q=U(T);O=_(Q,"THEAD",{"data-svelte-h":!0}),X(O)!=="svelte-1i92pqr"&&(O.innerHTML=Z),x=R(Q),Y=_(Q,"TBODY",{});var I=U(Y);for(let ge=0;ge<E.length;ge+=1)E[ge].l(I);ae=R(I),I.forEach(C),F=_(Q,"TBODY",{"data-svelte-h":!0}),X(F)!=="svelte-1pa1zxo"&&(F.innerHTML=ve),Q.forEach(C),_e=R(c),S&&S.l(c),le=R(c),J=_(c,"DIV",{class:!0});var ee=U(J);j=_(ee,"BUTTON",{class:!0,"data-svelte-h":!0}),X(j)!=="svelte-1crze23"&&(j.textContent=Te),ee.forEach(C),c.forEach(C),w.forEach(C),this.h()},h(){m(r,"class","text-4xl text-primary"),m(D,"class","textarea textarea-bordered textarea-md w-full"),m(D,"placeholder","Descrizione della spesa"),m(y,"class","grid grid-cols-2 items-center justify-center gap-2 w-full"),m(T,"class","table table-sm p-2 shadow bg-base-100 text-center"),m(j,"class","btn"),m(J,"class","modal-action"),m(t,"class",ne="modal-box flex flex-col space-y-3 "+(e[4]?"bg-neutral-content":"")),m(a,"class","modal modal-lg"),a.open=e[1]},m(l,w){te(l,a,w),o(a,t),o(t,r),o(r,d),o(r,b),o(r,u),o(t,s),M&&M.m(t,null),o(t,k),o(t,D),pe(D,e[0].description),o(t,B),o(t,y),re(p,y,null),o(y,L),re(q,y,null),o(t,H),re(V,t,null),o(t,g),re(n,t,null),o(t,i),o(t,T),o(T,O),o(T,x),o(T,Y);for(let c=0;c<E.length;c+=1)E[c]&&E[c].m(Y,null);o(Y,ae),o(T,F),o(t,_e),S&&S.m(t,null),o(t,le),o(t,J),o(J,j),P=!0,me||(Ce=[W(D,"input",e[11]),W(j,"click",e[17])],me=!0)},p(l,[w]){(!P||w&4)&&f!==(f=l[2]?"Visualizza":"Modifica")&&be(d,f),(!P||w&16)&&v!==(v=l[4]?"Rimborso":"Spesa")&&be(u,v),l[2]?M&&(M.d(1),M=null):M||(M=ze(),M.c(),M.m(t,k)),w&1&&pe(D,l[0].description);const c={};!A&&w&1&&(A=!0,c.categoria=l[0].category,Ee(()=>A=!1)),p.$set(c);const $={};!N&&w&1&&(N=!0,$.value=l[0].date,Ee(()=>N=!1)),q.$set($);const G={};w&16&&(G.topleftlabel=l[4]?"Aggiungere gli utenti da rimborsare":"Cerca un utente a cui associare una quota"),V.$set(G);const Q={};if(w&32&&(Q.value=he(l[5])),n.$set(Q),w&13){K=De(l[0].quote);let I;for(I=0;I<K.length;I+=1){const ee=Ie(l,K,I);E[I]?E[I].p(ee,w):(E[I]=Me(ee),E[I].c(),E[I].m(Y,ae))}for(;I<E.length;I+=1)E[I].d(1);E.length=K.length}l[2]?S&&(S.d(1),S=null):S?S.p(l,w):(S=Ue(l),S.c(),S.m(t,le)),(!P||w&16&&ne!==(ne="modal-box flex flex-col space-y-3 "+(l[4]?"bg-neutral-content":"")))&&m(t,"class",ne),(!P||w&2)&&(a.open=l[1])},i(l){P||(ie(p.$$.fragment,l),ie(q.$$.fragment,l),ie(V.$$.fragment,l),ie(n.$$.fragment,l),P=!0)},o(l){ue(p.$$.fragment,l),ue(q.$$.fragment,l),ue(V.$$.fragment,l),ue(n.$$.fragment,l),P=!1},d(l){l&&C(a),M&&M.d(),ce(p),ce(q),ce(V),ce(n),Oe(E,l),S&&S.d(),me=!1,Ve(Ce)}}}function he(e){return Number(e).toLocaleString("it-IT",{style:"currency",currency:"EUR"})}function Je(e,a,t){let r,f,d,{open:b=!1}=a,{nosave:v=!1}=a;const u=He();let{expense:s={quote:[],category:{}}}=a;function k(n){t(0,s.quote=[...s.quote,{user:n.detail,cost:0,rimborso:!!f}],s)}async function D(){await Xe(s),u("reload")}async function B(){await xe(s),u("reload")}function y(){return d.name==="Rimborso"}function p(){let n=s.quote;if(f&&n.length>1){let i=0;for(let T=1;T<n.length;T++)i+=n[T].cost,n[T].rimborso=!0;return n[0].cost=i,n[0].rimborso=!1,0}else return s.quote.forEach(i=>i.rimborso=!1),s.quote.reduce((i,T)=>i+T.cost,0)}function A(){s.description=this.value,t(0,s)}function L(n){e.$$.not_equal(s.category,n)&&(s.category=n,t(0,s))}const q=async n=>{p(),await Pe(),t(0,s.quote=[...s.quote],s)};function N(n){e.$$.not_equal(s.date,n)&&(s.date=n,t(0,s))}function H(n,i){n[i].cost=Ae(this.value),t(0,s)}const V=n=>{s.quote.splice(n,1),t(0,s.quote=[...s.quote],s)},g=()=>{u("close")};return e.$$set=n=>{"open"in n&&t(1,b=n.open),"nosave"in n&&t(2,v=n.nosave),"expense"in n&&t(0,s=n.expense)},e.$$.update=()=>{e.$$.dirty&1&&t(3,d=s.category),e.$$.dirty&9&&t(5,r=p()),e.$$.dirty&8&&t(4,f=y())},[s,b,v,d,f,r,u,k,D,B,p,A,L,q,N,H,V,g]}class lt extends Qe{constructor(a){super(),Ye(this,a,Je,Fe,Ne,{open:1,nosave:2,expense:0})}}export{lt as S};
