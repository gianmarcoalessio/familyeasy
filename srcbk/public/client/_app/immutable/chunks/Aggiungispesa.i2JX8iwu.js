import{s as He,l as De,e as c,t as Z,a as D,c as d,b as I,d as x,f as v,g as S,m as te,o as p,i as be,h as o,r as ce,p as ee,j as me,q as Se,u as Me,v as Le,w as Ve,z as ze,x as Ne,y as je}from"./scheduler.335M-m3f.js";import{S as Pe,i as Qe,b as Ie,c as re,a as se,m as oe,t as le,d as ie,e as ue}from"./index.K2G5X1vL.js";import{e as Ae}from"./each.6w4Ej4nR.js";import{I as Re}from"./Input.BkZDYS4g.js";import{C as Ye,S as Ge}from"./Search.234XupZN.js";import{g as Je}from"./servizi.Tbb05M6l.js";function Oe(e,s,a){const u=e.slice();return u[19]=s[a],u[20]=s,u[21]=a,u}function Xe(e){let s,a="x",u,E;function T(){return e[15](e[21])}return{c(){s=c("button"),s.textContent=a,this.h()},l(g){s=d(g,"BUTTON",{class:!0,"data-svelte-h":!0}),te(s)!=="svelte-3scbwu"&&(s.textContent=a),this.h()},h(){p(s,"class","btn")},m(g,y){be(g,s,y),u||(E=ee(s,"click",T),u=!0)},p(g,y){e=g},d(g){g&&v(s),u=!1,E()}}}function $e(e){let s,a,u,E=e[19].user.username+"",T,g,y,t,R,O,L,N,h,q,w,_,U,H;function A(){e[13].call(t,e[20],e[21])}function j(){e[14].call(q,e[20],e[21])}let k=e[21]>0&&Xe(e);return{c(){s=c("tr"),a=c("td"),u=Z("@"),T=Z(E),g=D(),y=c("td"),t=c("input"),N=D(),h=c("td"),q=c("input"),w=D(),_=c("td"),k&&k.c(),this.h()},l(n){s=d(n,"TR",{});var l=I(s);a=d(l,"TD",{class:!0});var f=I(a);u=x(f,"@"),T=x(f,E),f.forEach(v),g=S(l),y=d(l,"TD",{});var Y=I(y);t=d(Y,"INPUT",{type:!0,class:!0,placeholder:!0}),Y.forEach(v),N=S(l),h=d(l,"TD",{});var $=I(h);q=d($,"INPUT",{type:!0,class:!0}),$.forEach(v),w=S(l),_=d(l,"TD",{});var B=I(_);k&&k.l(B),B.forEach(v),l.forEach(v),this.h()},h(){p(a,"class","flex-1"),p(t,"type","number"),p(t,"class",R="w-40 text-lg p-2 text-center rounded-lg "+(e[19].rimborso?"text-success":"text-error")),p(t,"placeholder",O=de(e[19].cost)),t.disabled=L=e[21]==0&&e[2].name==="Rimborso",p(q,"type","checkbox"),q.disabled=!0,p(q,"class","toggle")},m(n,l){be(n,s,l),o(s,a),o(a,u),o(a,T),o(s,g),o(s,y),o(y,t),ce(t,e[19].cost),o(s,N),o(s,h),o(h,q),q.checked=e[19].rimborso,o(s,w),o(s,_),k&&k.m(_,null),U||(H=[ee(t,"input",A),ee(q,"change",j)],U=!0)},p(n,l){e=n,l&2&&E!==(E=e[19].user.username+"")&&me(T,E),l&2&&R!==(R="w-40 text-lg p-2 text-center rounded-lg "+(e[19].rimborso?"text-success":"text-error"))&&p(t,"class",R),l&2&&O!==(O=de(e[19].cost))&&p(t,"placeholder",O),l&4&&L!==(L=e[21]==0&&e[2].name==="Rimborso")&&(t.disabled=L),l&2&&Ne(t.value)!==e[19].cost&&ce(t,e[19].cost),l&2&&(q.checked=e[19].rimborso),e[21]>0&&k.p(e,l)},d(n){n&&v(s),k&&k.d(),U=!1,Le(H)}}}function Fe(e){let s,a,u,E,T=e[3]?"Rimborso":"Spesa",g,y,t,R,O=e[3]?"un rimborso":"una spesa",L,N,h,q,w,_,U,H,A,j,k,n,l,f,Y,$,B,ve="<tr><th>Username</th> <th>Quota</th> <th>Spesa/Rimborso</th> <th></th></tr>",fe,P,ae,G,Te="",pe,M,ye="Aggiungi",ge,J,V,qe="Close",ne,z,he,Ce;function Ue(r){e[10](r)}let Ee={};e[1].category!==void 0&&(Ee.categoria=e[1].category),_=new Ye({props:Ee}),De.push(()=>Ie(_,"categoria",Ue)),_.$on("change",e[11]);function Be(r){e[12](r)}let ke={placeholder:"",type:"date"};e[1].date!==void 0&&(ke.value=e[1].date),A=new Re({props:ke}),De.push(()=>Ie(A,"value",Be)),n=new Ge({props:{topleftlabel:e[3]?"Aggiungere gli utenti da rimborsare":"Cerca un utente a cui associare una quota"}}),n.$on("add",e[6]),f=new Re({props:{topleftlabel:"Totale spesa (somma delle quote)",disabled:!0,value:de(e[4])}});let X=Ae(e[1].quote),b=[];for(let r=0;r<X.length;r+=1)b[r]=$e(Oe(e,X,r));return{c(){s=c("dialog"),a=c("div"),u=c("div"),E=Z("Aggiungi "),g=Z(T),y=D(),t=c("div"),R=Z("Completare i campi per aggiungere "),L=Z(O),N=D(),h=c("textarea"),q=D(),w=c("div"),re(_.$$.fragment),H=D(),re(A.$$.fragment),k=D(),re(n.$$.fragment),l=D(),re(f.$$.fragment),Y=D(),$=c("table"),B=c("thead"),B.innerHTML=ve,fe=D(),P=c("tbody");for(let r=0;r<b.length;r+=1)b[r].c();ae=D(),G=c("tbody"),G.innerHTML=Te,pe=D(),M=c("button"),M.textContent=ye,ge=D(),J=c("div"),V=c("button"),V.textContent=qe,this.h()},l(r){s=d(r,"DIALOG",{class:!0});var C=I(s);a=d(C,"DIV",{class:!0});var i=I(a);u=d(i,"DIV",{class:!0});var F=I(u);E=x(F,"Aggiungi "),g=x(F,T),F.forEach(v),y=S(i),t=d(i,"DIV",{});var K=I(t);R=x(K,"Completare i campi per aggiungere "),L=x(K,O),K.forEach(v),N=S(i),h=d(i,"TEXTAREA",{class:!0,placeholder:!0}),I(h).forEach(v),q=S(i),w=d(i,"DIV",{class:!0});var Q=I(w);se(_.$$.fragment,Q),H=S(Q),se(A.$$.fragment,Q),Q.forEach(v),k=S(i),se(n.$$.fragment,i),l=S(i),se(f.$$.fragment,i),Y=S(i),$=d(i,"TABLE",{class:!0});var m=I($);B=d(m,"THEAD",{"data-svelte-h":!0}),te(B)!=="svelte-1ashv4j"&&(B.innerHTML=ve),fe=S(m),P=d(m,"TBODY",{});var W=I(P);for(let _e=0;_e<b.length;_e+=1)b[_e].l(W);ae=S(W),W.forEach(v),G=d(m,"TBODY",{"data-svelte-h":!0}),te(G)!=="svelte-1pa1zxo"&&(G.innerHTML=Te),m.forEach(v),pe=S(i),M=d(i,"BUTTON",{class:!0,"data-svelte-h":!0}),te(M)!=="svelte-v4vzth"&&(M.textContent=ye),ge=S(i),J=d(i,"DIV",{class:!0});var we=I(J);V=d(we,"BUTTON",{class:!0,"data-svelte-h":!0}),te(V)!=="svelte-9u1up7"&&(V.textContent=qe),we.forEach(v),i.forEach(v),C.forEach(v),this.h()},h(){p(u,"class","text-4xl text-primary "),p(h,"class","textarea textarea-bordered textarea-md w-full"),p(h,"placeholder","Descrizione della spesa"),p(w,"class","grid grid-cols-2 items-center justify-center gap-2 w-full"),p($,"class","table p-2 shadow bg-base-100 w-full text-center"),p(M,"class","btn btn-primary w-full"),p(V,"class","btn"),p(J,"class","modal-action"),p(a,"class",ne="modal-box flex flex-col space-y-3 "+(e[3]?"bg-neutral-content":"")),p(s,"class","modal"),s.open=e[0]},m(r,C){be(r,s,C),o(s,a),o(a,u),o(u,E),o(u,g),o(a,y),o(a,t),o(t,R),o(t,L),o(a,N),o(a,h),ce(h,e[1].description),o(a,q),o(a,w),oe(_,w,null),o(w,H),oe(A,w,null),o(a,k),oe(n,a,null),o(a,l),oe(f,a,null),o(a,Y),o(a,$),o($,B),o($,fe),o($,P);for(let i=0;i<b.length;i+=1)b[i]&&b[i].m(P,null);o(P,ae),o($,G),o(a,pe),o(a,M),o(a,ge),o(a,J),o(J,V),z=!0,he||(Ce=[ee(h,"input",e[9]),ee(M,"click",e[7]),ee(V,"click",e[16])],he=!0)},p(r,[C]){(!z||C&8)&&T!==(T=r[3]?"Rimborso":"Spesa")&&me(g,T),(!z||C&8)&&O!==(O=r[3]?"un rimborso":"una spesa")&&me(L,O),C&2&&ce(h,r[1].description);const i={};!U&&C&2&&(U=!0,i.categoria=r[1].category,Se(()=>U=!1)),_.$set(i);const F={};!j&&C&2&&(j=!0,F.value=r[1].date,Se(()=>j=!1)),A.$set(F);const K={};C&8&&(K.topleftlabel=r[3]?"Aggiungere gli utenti da rimborsare":"Cerca un utente a cui associare una quota"),n.$set(K);const Q={};if(C&16&&(Q.value=de(r[4])),f.$set(Q),C&6){X=Ae(r[1].quote);let m;for(m=0;m<X.length;m+=1){const W=Oe(r,X,m);b[m]?b[m].p(W,C):(b[m]=$e(W),b[m].c(),b[m].m(P,ae))}for(;m<b.length;m+=1)b[m].d(1);b.length=X.length}(!z||C&8&&ne!==(ne="modal-box flex flex-col space-y-3 "+(r[3]?"bg-neutral-content":"")))&&p(a,"class",ne),(!z||C&1)&&(s.open=r[0])},i(r){z||(le(_.$$.fragment,r),le(A.$$.fragment,r),le(n.$$.fragment,r),le(f.$$.fragment,r),z=!0)},o(r){ie(_.$$.fragment,r),ie(A.$$.fragment,r),ie(n.$$.fragment,r),ie(f.$$.fragment,r),z=!1},d(r){r&&v(s),ue(_),ue(A),ue(n),ue(f),Me(b,r),he=!1,Le(Ce)}}}function de(e){return Number(e).toLocaleString("it-IT",{style:"currency",currency:"EUR"})}function Ke(e,s,a){let u,E,T,{open:g=!1}=s;const y=Ve();let t={quote:[],category:{}},R={};ze(()=>{a(1,t={description:"",quote:[{user:{_id:"",username:""},cost:0,rimborso:!1}],category:{},date:new Date().toISOString().slice(0,10)}),R=JSON.parse(localStorage.getItem("token")),a(1,t.quote[0].user.username=R.username,t),a(1,t.quote[0].user._id=R._id,t)});function O(n){a(1,t.quote=[...t.quote,{user:n.detail,cost:0,rimborso:!1}],t)}async function L(){a(1,t.category=u,t),await Je(0,0,t),y("reload")}function N(){return u.name==="Rimborso"}function h(){let n=t.quote;if(T&&n.length>1){let l=0;for(let f=1;f<n.length;f++)l+=n[f].cost,n[f].rimborso=!0;return n[0].cost=l,n[0].rimborso=!1,0}else return t.quote.reduce((l,f)=>(f.rimborso=!1,l+f.cost),0)}function q(){t.description=this.value,a(1,t)}function w(n){e.$$.not_equal(t.category,n)&&(t.category=n,a(1,t))}const _=async n=>{h(),await je(),a(1,t.quote=[...t.quote],t)};function U(n){e.$$.not_equal(t.date,n)&&(t.date=n,a(1,t))}function H(n,l){n[l].cost=Ne(this.value),a(1,t)}function A(n,l){n[l].rimborso=this.checked,a(1,t)}const j=n=>{t.quote.splice(n,1),a(1,t.quote=[...t.quote],t)},k=()=>{y("close")};return e.$$set=n=>{"open"in n&&a(0,g=n.open)},e.$$.update=()=>{e.$$.dirty&2&&a(2,u=t.category),e.$$.dirty&6&&a(4,E=h()),e.$$.dirty&4&&a(3,T=N())},[g,t,u,T,E,y,O,L,h,q,w,_,U,H,A,j,k]}class nt extends Pe{constructor(s){super(),Qe(this,s,Ke,Fe,He,{open:0})}}export{nt as A};
